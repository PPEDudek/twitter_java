package ppe.favre.twittertimeline.java.com;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStream;


import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class Json {

	static JSONArray jobj = null;
	static String json = "";
	public int tweetId;
	public int userId;
	String date = "";
	static String text = "";
	String name = "";
	String location = "";
	String description = "";
	
	public JSONArray ReadJson () throws IOException, JSONException {
		// Read Json file for test
		
		BufferedReader reader = new BufferedReader(new FileReader("E:/Utilisateur/Documents/PPE B2/home.json"));
		StringBuilder sb = new StringBuilder();
		String line = null;
		try {
			while ((line =reader.readLine())!= null) {
				sb.append(line+"\n");
			}
			json = sb.toString();
			try {
				jobj = new JSONArray(json);
			} catch (JSONException e) {
				e.printStackTrace();
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
		ParseJson();
		reader.close();
		return jobj;
	}
	
	public void ParseJson () throws JSONException {
		/*
		 * 	Parsing of Json
		 */
		JSONArray jsonarray = new JSONArray(json);
		for(int i = 0; i < jsonarray.length(); i++) {
			
			//Récupération premier tweet
			JSONObject tweetObj = jsonarray.getJSONObject(i);
			this.date = tweetObj.getString("created_at");
			this.tweetId = tweetObj.getInt("id");
			this.text = tweetObj.getString("text");
			
			// Récupération premier tweet -> user 
			JSONObject userObj = tweetObj.getJSONObject("user");
			this.userId = userObj.getInt("id");
			this.name = userObj.getString("name");
			location = userObj.getString("location");
			this.description = userObj.getString("description");
			
			System.out.println("---------  TWEET  -----------");
			System.out.println("UserId: " + userId + "   Nom: " + name);
			System.out.println(date);
			System.out.println("TweetId: " + tweetId + "   Texte: " + text);
			System.out.println();
			System.out.println();
		}
	}
}
